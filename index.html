<html>

<head>
    <title>Parengage - Grades</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" href="css/simple-sidebar.css">
</head>

<body>
    <div class="col-md-4 col-sm-6 col-xs-8" id="content">
        <h1>Parengage - Grades</h1>
        <script src="js/toolbar.js"></script>
        <script src="js/jquery-2.2.3.min.js"></script>
        <div id="table_div"></div>

    </div>
</body>

<script>
// should make table code more flexible - what if we add a teacher to the json, for example
    $.getJSON("data.json", function(data) {

        function detail(teacher) {

            document.getElementById("table_div").innerHTML = "Details for " + key_array[teacher - 1];
            // specific_tableCreate();
            console.log(data_array[teacher-1].detailedGrades);
            document.getElementById("table_div").appendChild(document.createElement("br"));
            var back_button = document.createElement("button");
            back_button.innerText = "Back"
            back_button.onclick = function() {
            	document.getElementById("table_div").innerHTML = "";
            	overall_tableCreate();
            }
            document.getElementById("table_div").appendChild(back_button);
        }


        var headers = ["Subject", "Teacher", "Grade"]


        var data_array = [];
        for (var key in data) {
            if (data.hasOwnProperty(key)) {
                data_array.push(data[key]);
            }
        }

        var key_array = [];
        for (var key in data) {
            if (data.hasOwnProperty(key)) {
                key_array.push(key);
            }
        }

        function specific_tableCreate() {
                tbl = document.createElement('table');
            tbl.className = "table .table-striped";
            tbl.id = "grade_table";
            tbl.style.width = '100%';
            tbl.style.border = '1px solid black';

            for (var i = 0; i < 7; i++) {
                var tr = tbl.insertRow();
                tr.id = i;
                if (i>0) {
                tr.onclick = function() {
                    detail(this.id)
                };
                tr.className = "clickable";
            }

            gen_headers = ["Assignment", "Grade"]

                for (var j = 0; j < 2; j++) {


                	if (i==0) {
                		//populate headers here
                		var td = document.createElement("th");
                		tr.appendChild(td);
                	} else {
                    var td = tr.insertCell();
                }
                    if (i > 0) {


                        if (j == 1) {
                            td.appendChild(document.createTextNode(key_array[i - 1]));
                        } else if (j == 0) {
                            // not teacher column
                            td.appendChild(document.createTextNode(data_array[i - 1].subject));
                        } else {
                            td.appendChild(document.createTextNode(data_array[i - 1].grade));

                        }
                    } else {
                        td.appendChild(document.createTextNode(gen_headers[j]))
                    }
                    td.style.border = '1px solid black';
                }

            }

            document.getElementById("table_div").appendChild(tbl);
        }
        

        // thanks to http://stackoverflow.com/questions/14643617/create-table-using-javascript
        function overall_tableCreate() {
            var body = document.body,
                tbl = document.createElement('table');
            tbl.className = "table .table-striped";
            tbl.id = "grade_table";
            tbl.style.width = '100%';
            tbl.style.border = '1px solid black';

            for (var i = 0; i < 7; i++) {
                var tr = tbl.insertRow();
                tr.id = i;
                if (i>0) {
                tr.onclick = function() {
                    detail(this.id)
                };
                tr.className = "clickable";
            }

                for (var j = 0; j < 3; j++) {


                	if (i==0) {
                		//populate headers here
                		var td = document.createElement("th");
                		tr.appendChild(td);
                	} else {
                    var td = tr.insertCell();
                }
                    if (i > 0) {


                        if (j == 1) {
                            td.appendChild(document.createTextNode(key_array[i - 1]));
                        } else if (j == 0) {
                            // not teacher column
                            td.appendChild(document.createTextNode(data_array[i - 1].subject));
                        } else {
                            td.appendChild(document.createTextNode(data_array[i - 1].grade));

                        }
                    } else {
                        td.appendChild(document.createTextNode(headers[j]))
                    }
                    td.style.border = '1px solid black';
                }

            }

            document.getElementById("table_div").appendChild(tbl);
        }
        overall_tableCreate();
    });
</script>

</html>